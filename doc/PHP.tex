\documentclass{article}
\usepackage[latin1]{inputenc}
\usepackage[ngerman]{babel}
\usepackage{graphicx}
\usepackage{enumitem}
\usepackage{multirow}
\usepackage{threeparttable}
\usepackage{lscape}
\usepackage{amsmath}

\begin{document}

\title{Automatisierung der WSUS Auswertung
\\ Ein Projekt mit PHP\textbackslash MSSQL}
\author{Gennaro Piano}
\date{\today}

\maketitle

\begin{figure}[htbp]
		\centering
	\includegraphics[width=10cm]{wsus.jpg}
		\label{fig:logo}
\end{figure}

\newpage
\tableofcontents
\newpage
\section{Einleitung}
\subsection{Ausgangslage}
Wir bieten unseren Kunden die Möglichkeit die Windows Updates über unserem WSUS Server herunterzuladen. Durch dieses Angebot muss sich der Kunde nicht mehr über fehlerhaften Updates kümmern, da wir die Updates zuerst in einer Testumgebung testen und diese danach freigeben. Um die Updateverwaltung einfach zu halten wurden auf dem WSUS Server Produktklassen erstellt. Computer und Server von Kunden die unser Angebot nutzen möchten, werden den entsprechenden Produktklassen zugeteilt. Updates die freigegeben sind werden wiederum den entsprechenden Produktklassen zugeteilt und somit auf den Geräten der Kunden installiert. Dieses System ist gut durchdacht, jedoch ist es sehr kompliziert diese Daten auszuwerten. \newline \newline
Um die Daten auszuwerten werden jedes Quartal alle freigegebenen Updates manuell in einer Excel Datei aufgenommen. Jedes Update wird danach in die entsprechende Produktklasse kopiert. Auf einem weiterem Excel Blatt wird ausgewertet, welcher Benutzer welche Produktklassen benötigt. Dieser Prozess ist sehr zeitintensiv und kostet pro Quartal circa eins bis zwei Arbeitstage.
\subsection{Ziel der Arbeit}
Um den Aufwand zu kürzen soll der Ablauf des Prozesses so weit wie möglich automatisiert werden. Dies soll mit PHP und einem MS SQL Server realisiert werden. Im ersten Schritt soll die Verbindung zwischen den Updates und den Produktklassen programmiert werden. Als zweiter Schritt werden die Kunden hinzugefügt und die Auswertung automatisiert. Diese Arbeit befasst sich mit dem ersten Schritt des Projekts.
\newpage
\section{Requierements}
\subsection{Einleitung}
\textbf{Zweck} \newline
Dieser Teil des Dokuments befasst sich mit den Anforderungen, des Projekts. Diese Anforderungen werden mit dem Auftraggeber angeschaut. Erst wenn die Anforderungen vom Auftraggeber bestätigt worden sind und nach seiner Meinung alles abgedeckt ist, wird das Projekt fortgeführt.
\newline
\newline
\textbf{Systemumfang} \newline
Das System wird für den internen Gebrauch entwickelt und soll von aussen nicht zugänglich sein. Somit besteht keine Gefahr, die Applikation vor unerlaubten Zugriff zu schützen, da dies die Firewall handhabt. 
\newline
\newline
\textbf{Auftraggeber} \newline
Der Auftraggeber dieses Projekts ist zugleich der interne technische Leiter der Firma. Somit wird das Projekt als internes Projekt gehandhabt. Der technische Leiter ist kein Programmierer und stellt deswegen keine technische Anforderungen an das Projekt. Der technische Leiter wird für dieses Projekt als Kunde angesehen.\newline \newline
\subsection{Allgemeine Übersicht}
\textbf{Systemumfeld} \newline
Diese Applikation benötigt einen Webserver und eine Schnittstelle zu einer Microsoft SQL Datenbank. Der WSUS Server gehört auch zum Systemumfeld, jedoch ist die Verbindung zwischen dem WSUS Server und der Applikation nur abstrakt, da die entnommenen Informationen aus dem WSUS Server manuell in der Applikation aufgenommen werden.
\begin{figure}[htbp]
		\centering
	\includegraphics[width=10cm]{C:/inetpub/wwwroot/auswertung/doc/img/Systemumfeld.jpg}
		\label{fig:Systemumfeld}
\end{figure}
\newpage
\parindent0pt \textbf{Architekturbeschreibung} \newline
Die PHP Applikation wird auf dem schon vorhandenen Webserver implementiert. Es handelt sich um einen IIS, dies ist der Webserver von Microsoft. Der IIS unterstützt von sich aus kein PHP. Somit muss der PHP Interpreter nachgerüstet werden. Der PHP Interpreter wird mit dem integrierten Webplattform Installer installiert. Für die Datenbankanbindung wird ebenfalls der vorhandene SQL Server benutzt. Auf diesem Server wird eine neue Datenbank und ein neuer Datenbankbenutzer erstellt. Der neue Benutzer wird nur auf diese Datenbank Zugriff haben, zugleich wird er der einzige Benutzer sein, der auf die neue Datenbank Zugriff hat. Der Webserver und der SQL Server befinden sich physikalisch auf dem gleichen Server, somit ist hardwaremässig nur ein Server von den Veränderungen betroffen. Der PHP Interpreter benötigt eine Schnittstelle um auf die Datenbank zu lesen und zu schreiben, die Schnittstelle zwischen PHP und einem Microsoft SQL Server wird nicht automatisch installiert und muss somit manuell nachinstalliert werden.
\newline
\newline
\textbf{Systemfunktionalität} \newline
Das Use Case Diagramm soll die Funktionalität des Systems aufzeigen.
\begin{figure}[htbp]
		\centering
	\includegraphics[width=14.5cm]{C:/inetpub/wwwroot/auswertung/doc/img/Use_Case.jpg}
		\label{fig:UseCaseDiagramm}
\end{figure}
\newpage
\parindent0pt \textbf{Nutzer und Zielgruppen} \newline
Der Hauptnutzer ist zugleich der Auftraggeber dieses Projekts. Neben dem Auftraggeber wird die Webapplikation auch von seinem Stellvertreter benutzt werden, dies wird jedoch sehr selten der Fall sein. Der Zugriff auf die Webapplikation wird für alle Benutzer des Unternehmens möglich sein, dies ist bei der momentanen Excel Datei auch der Fall.
\newline
\newline
\textbf{Annahmen} \newline
Der zweite Teil des Projekts wird wie oben bereits erwähnt erst später entwickelt. In dieser Dokumentation wird auf den zweiten Teil des Projekts bewusst nicht eingegangen, da dies ansonsten den Umfang dieses Dokuments sprengen würde.
\subsection{Anforderungen}
\begin{itemize}
\item Die Applikation muss dem Benutzer ermöglichen, neue Updateeinträge durch eine Maske in die Datenbank einzutragen. 
\item Die Applikation muss dem Benutzer ermöglichen, über eine Maske nach Updateeinträge auf der Datenbank zu suchen. 
\item Die Applikation muss dem Benutzer ermöglichen, über eine Maske Updateeinträge auf der Datenbank zu verändern und zu löschen. 
\item Die Applikation muss dem Benutzer ermöglichen, neue Packageeinträge durch eine Maske in die Datenbank einzutragen. 
\item Die Applikation muss dem Benutzer ermöglichen, über eine Maske nach Packageeinträge auf der Datenbank zu suchen. 
\item Die Applikation muss dem Benutzer ermöglichen, über eine Maske Packageeinträge auf der Datenbank zu verändern und zu löschen. 
\item Die Applikation muss dem Benutzer alle Packagezuweisungen eines Updateeintrag aufzeigen, wenn der Benutzer den Updateeintrag anschaut. 
\item Die Applikation muss dem Benutzer ermöglichen, über eine Maske ein Packageeintrag, dem entsprechendem Typ zuzuordnen. 
\item Andersum soll die Applikation dem Benutzer alle Updateeinträge eines Packages aufzeigen, wenn der Benutzer den Packageeintrag anschaut. 
\item Sobald der Benutzer einen neuen Updateeintrag eröffnen will, soll die Applikation ihm die Packages aufzeigen, damit er sogleich die Verknüpfung erstellen kann.
\end{itemize}
\newpage
Beim Speichervorgang des neuen Eintrag soll das System folgende Einträge die durch den Benutzer erfolgt sind überprüfen:
\begin{itemize}
\item Der Titel eines Updateeintrag darf nicht leer sein.
\item Die KB Nummer eines Updateeintrags darf nicht leer sein und muss einen numerischen Wert haben.
\item Das Veröffentlichungsdatum eines Updateeintrags darf nicht leer sein.
\item Ein Updateeintrag kann mehreren Packages zugeteilt werden.
\item Datumsfelder werden nur als dd.mm.JJJJ angenommen
\item Ein Updateeintrag kann keinem Package zugeteilt werden.
\item Ein Update kann von Microsoft auch zurückgezogen werden, dies sollte ebenfalls im Datensatz aufgenommen werden können. Dieser kann auch leer sein.
\item Sobald der ein Update mindestens einem Package zugeteilt worden ist, muss der Benutzer auch ein Approvement Daten setzen. 
\item Falls das Update keinem Package zugeteilt worden ist, darf kein Approvement Datum gesetzt sein.
\item Der Titel eines Packageeintrag darf nicht leer sein.
\item Der Typ eines Packageeintrag darf nicht leer sein.
\end{itemize}
Falls eine dieser Überprüfungen fehlschlägt, darf der Eintrag nicht gespeichert werden. Die Anforderungen des Speicher- und Änderungsvorgangs sind identisch. Das Löschen eines Updateeintrag muss die Verknüpfung zu den zugeteilten Packages ebenfalls löschen. Das Löschen eines Packageeintrag muss wiederum die Verknüpfungen zu den implementierten Updates löschen.
\subsection{Analyse der Anforderungen}
\newpage
\section{Entwicklung}
\subsection{Einleitung}
Dieses Kapitel des Dokuments handelt um die Planung und Entwicklung des Programms.  
\subsection{Datenbank}
Um die aufgenommenen Updates zu speichern, wird eine Datenbank benötigt. Vor der Erstellung der Datenbank wurde ein Entity Relationship Diagram erstellt. Auf der nächsten Seite befindet sich ein genaue Beschreibung der Tabellen und Attributen. Der Text in Klammern beschreibt die Eigenschaften der Attributen.
\begin{figure}[htbp]
		\centering
	\includegraphics[width=14.5cm]{C:/inetpub/wwwroot/auswertung/doc/img/Datenbank.jpg}
		\label{fig:Datenbank}
\end{figure}
\newpage
\subsubsection{Tabelle update}
In dieser Tabelle befinden sich alle Informationen, die ein Update benötigt.
\begin{itemize}
\item \textbf{id} (Primärschlüssel, int, auto increment, NOT NULL) \newline 
Wird für die Verbindung zur Tabelle update\_package benötigt. 
\item \textbf{name} (varchar(400), NOT NULL) \newline 
Das ist der Titel des Updates, da der Titel recht lange sein kann, wird der String auf 400 Zeichen begrenzt. Diese Attribut ist ein Pflichtfeld.
\item \textbf{kb} (int, NOT NULL) \newline
Das ist die KB Nummer\footnote{Knowlegde Base Number: Wird für Microsoft genutzt, um Updates eindeutig zu kennzeichnen} des Updates. Dieses Attribut wurde nicht als Primary Key benutzt, da es schon vorgekommen ist, das zwei Updates die selbe KB Nummer haben. Dieses Attribut ist ein Pflichtfeld, da jedes Update eine KB Nummer hat.
\item \textbf{release} (date, NOT NULL) \newline
Dieses Attribut beinhaltet das Erscheinungsdatum des Updates. Es ist ein Pflichtfeld, da jedes Update dass eingetragen wird, schon erschienen ist.
\item \textbf{decline} (date) \newline
Falls ein Update von Microsoft wegen einem Bug zurückgenommen wird, wird dieses Datum in diesem Feld eingefügt.
\item \textbf{approve\_clt} (date)  \newline 
Dieses Attribut beinhaltet das Datum, an dem das Update für die Clients freigegeben wurde. Dieses Feld darf leer sein, da nicht jedes Update zwingend für Clients ist.
\item \textbf{approve\_srv} (date) \newline
Dieses Attribut beinhaltet das Datum, an dem das Update für die Server freigegeben wurde. Dieses Feld darf leer sein, da nicht jedes Update zwingend für Server ist.
\end{itemize}
\subsubsection{Tabelle update\_package}
Diese Tabelle ist eine Zwischentabelle. Durch diese Tabelle wird die Beziehung zwischen den Tabellen update und package ermöglicht. In dieser Tabelle besteht der Primärschlüssel aus zwei Attributen.
\begin{itemize}
\item \textbf{updateId} (Primary Key, int, NOT NULL) \newline 
Dieses Attribut enthält von jedem Update, welches mit einem Package verknüpft wurde, den entsprechenden Fremdschlüssel.
\item \textbf{packageId} (Primary Key, int, NOT NULL) \newline
Dieses Attribut enthält von jedem Package, welches mit einem Update verknüpft wurde, den entsprechenden Fremdschlüssel.
\end{itemize}
\subsubsection{Tabelle package}
Diese Tabelle beinhaltet alle Informationen die ein Package benötigt.
\begin{itemize}
\item \textbf{id} (Primary Key, Auto Increment, int, NOT NULL) \newline
Wird für die Beziehung zur Tabelle update benötigt.
\item \textbf{name} (varchar(50), NOT NULL) \newline
Das ist der Titel des Package, die Stringgrösse von diesem Attribut wurde auf 50 Zeichen gesetzt.
\item \textbf{typeId} (int, NOT NULL) \newline
Dies ist der Fremdschlüssel der Tabelle type, er wird für die Beziehung zwischen den Tabellen package und type benutzt.
\end{itemize}
\subsubsection{Tabelle type}
Diese Tabelle beinhaltet alle Typen der Packages. Sie wird benötigt um Redundanz und somit Dateninkonsistenz zu vermeiden. \newline
\begin{itemize}
\item \textbf{id} (Primary Key, int, Auto Increment, NOT NULL) \newline
Wird für die Beziehung zwischen den Tabellen type und package benötigt. 
\item \textbf{type} (varchar(10), NOT NULL) \newline 
Dieses Attribut beinhaltet den Namen des Typs. Die Stringgrösse wird auf 10 gesetzt, da die momentan benötigten Typen relativ kurz sind
\end{itemize}
\subsection{Sofwarearchitektur}
Das Programm wird mit der Sprache PHP entwickelt. Das ganze Programm wird nach dem MVC Konzept konzipiert. Das Programm muss folgende Funktionen anbieten.
\begin{itemize}
\item Suchen von Updates und Packages
\item Erstellen, ändern und löschen von Updates
\item Erstellen, ändern und löschen von Packages
\item Anzeigen der Packages und den beinhalteten Updates
\end{itemize}
Durch diese gewünschten Funktionen entsteht folgendes Klassendiagramm.

\end{document}
